import{_ as y}from"./Talks24-ruMsnwKG.js";import{_ as S,H as c,o as i,c as d,a as t,n as h,t as b,I,J as A,b as p,d as v,F as U,s as C,v as B}from"./index-BV5t7kmq.js";import{j as N,i as Q}from"./verify-DFBhVNLZ.js";import"./isWithinInterval-DuVRg0r3.js";const R={components:{Talks24:y},data:()=>({selectedDay:2,day1:"U2FsdGVkX1+iO3u49D3q6rlcds7ZJOz4N8+vuQz+VYo=",day2:"U2FsdGVkX19TiGQLj7xCUJBO02Zg78fjU1zyOE64GsQ=",chat:"U2FsdGVkX1/BKQP6AzzQFrb28NyI/BbFuQvgO4Ipq6RMnvdrRMI/qd0Lwxi4grBNerT48tEJF/IKMcxZYMzdrA==",token:{},public:`-----BEGIN PUBLIC KEY-----
MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEA1RHu1qgXJ81+2tlBy4UF
B8OdRsBjWhswMQaS/NhA2yWBaQiQ1YG4Tzen2aNmlTIkTBhSR3hqOnkzPQq77nMs
KP9HD1WHz/UNici/a/2UwXFy9bOyX+GKnPCtdcvZrIougvW5K7EBeUWcgY68xNQk
V9vFq4GSczOud7juk62eqqV26esV5tE2c4/J714SYwUl6NqLc7XeQNZMrsRHabIL
Bzg+A+2kw1jiJpJsJliPCT9T/NiAMrbZk1KR/NQ7uHARclAk13LwLwm5JfOhyKSs
Qkdfr8rVYuj3DDQCitea269Xy5RsFW/Cqyh3gHzt7bB9auU3UFaAXWPvnPURhTO4
Yf3c7YrizmpTfDGPIG/7zkegx9nPiBPNIGPq/LpmCC9iawNH7ixOH8ZC5Ijrti0b
8rMnuJBKysZxIowJAFvd7Zh+soekUei90qQnYwhFO49h7fwXXSq2sGeRfpg99Nu/
RdqqxM2zCMPpVMWHjxAVIubgNW5ZA33PW1wS075npC3oK+YUh2xt/9A6Ll4AcAOt
oaCmENEyeZEnHlaEWeXhNPQv1/nZN5Z3Fq3uKWCQRry1HMoOGKrdATfUUIXc6vvk
nRPuT57RDafiyxjektPLx0z2LvRZZb7lU5G9/+rO2yJ1f65Sd5k0drIb48YZ+OBj
6IrJDlqg3BaMV5Hr8LdQtY8CAwEAAQ==
-----END PUBLIC KEY-----`,dataReady:!1,error:!1,chatShown:!0,speakers:[]}),computed:{streamUrl(){const e=this.selectedDay===1?this.day1:this.day2;return`https://www.youtube.com/embed/${c.AES.decrypt(e,this.token.liveHash).toString(c.enc.Utf8)}?rel=0&autoplay=1&mute=0&controls=1&origin=https%3A%2F%2Frobocon.io&playsinline=0&showinfo=0&modestbranding=1`},chatUrl(){return c.AES.decrypt(this.chat,this.token.liveHash).toString(c.enc.Utf8)},isFullScreen(){return this.token.name==="gather"}},async created(){const e=new Date;e.getDate()===29&&e.getMonth()===2&&(this.selectedDay=2);const s=new URLSearchParams(window.location.search),n=Object.fromEntries(s.entries()).auth||window.localStorage.getItem("auth"),r=Object.fromEntries(s.entries()).attendee||window.localStorage.getItem("attendee");if(typeof n<"u"&&typeof r<"u"){window.history.replaceState({},document.title,"/stream"+window.location.hash),r!=="gather"&&(window.localStorage.setItem("auth",n),window.localStorage.setItem("attendee",r));try{const{payload:a}=await N(n,await Q(this.public,"RS256"),{issuer:"pretix"});this.token=a,a.name!==r&&(console.log("invalid Attendee"),this.error=!0)}catch(a){this.error=!0,console.error(a)}}this.dataReady=!0,Promise.all([fetch("https://cfp.robocon.io/api/events/robocon-2024/submissions/"),fetch("https://cfp.robocon.io/api/events/robocon-2024/submissions/?offset=25"),fetch("https://cfp.robocon.io/api/events/robocon-2024/submissions/?offset=50")]).then(async([a,o,m])=>{const l=await a.json(),w=await o.json(),f=await m.json(),k=[...l.results,...w.results,...f.results];this.speakers=k.flatMap(({speakers:g})=>g)})}},u=e=>(C("data-v-a8df2e38"),e=e(),B(),e),D={key:0},F={class:"px-small py-xsmall bg-black row between"},P=["src"],E=["src"],O={key:1,class:"color-white mt-2xlarge type-center type-xlarge"},q=u(()=>t("span",{class:"color-theme"},"IN",-1)),j=u(()=>t("span",null,"VALID",-1)),K=u(()=>t("span",{class:"color-theme"},"AUTH",-1)),M=[q,j,K],_={key:2,class:"container narrow"};function z(e,s,n,r,a,o){const m=y;return i(),d(U,null,[e.dataReady&&!e.error?(i(),d("div",D,[t("div",F,[t("div",null,[t("button",{class:h(["theme small type-small mr-small",e.selectedDay===1&&"active"]),onClick:s[0]||(s[0]=l=>e.selectedDay=1)},"Day 1",2),t("button",{class:h(["theme small type-small",e.selectedDay===2&&"active"]),onClick:s[1]||(s[1]=l=>e.selectedDay=2)},"Day 2",2)]),t("button",{onClick:s[2]||(s[2]=l=>e.chatShown=!e.chatShown),class:"theme small type-small"},b(e.chatShown?"Hide Q&A":"Show Q&A"),1)]),t("div",{class:h(["stream-container",o.isFullScreen&&"fullscreen"])},[t("iframe",{class:h(["stream col-sm-12",e.chatShown&&"col-md-9"]),src:o.streamUrl,title:"Robocon stream",frameborder:"0",allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture; web-share",allowfullscreen:""},null,10,P),I(t("iframe",{class:"chat col-sm-12 col-md-3",src:o.chatUrl,frameBorder:"0",title:"Stream chat"},null,8,E),[[A,e.chatShown]])],2)])):p("",!0),e.dataReady&&e.error?(i(),d("h1",O,M)):p("",!0),o.isFullScreen?p("",!0):(i(),d("div",_,[v(m,{hashKey:e.token.hashKey,speakers:[e.speakers]},null,8,["hashKey","speakers"])]))],64)}const J=S(R,[["render",z],["__scopeId","data-v-a8df2e38"]]);export{J as default};
